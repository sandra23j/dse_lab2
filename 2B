import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.preprocessing import LabelEncoder
from scipy.stats import zscore
from scipy import stats
from sklearn.preprocessing import LabelEncoder
data=pd.read_csv("pre.csv")
data.info()
plt.boxplot(data["salary"])
columns_to_check=['salary']
z_score=stats.zscore(data[columns_to_check])
threshold=3
outlier_indices_u=(z_score > threshold).any(axis=1)
outlier_indices_l=(z_score < -3).any(axis=1)
clean=data[~outlier_indices_u]
print(len(clean))
clean.info()
lower_limit=data[columns_to_check].quantile(0.05)
upper_limit=data[columns_to_check].quantile(0.95)

df_capped=data.copy()
df_capped[columns_to_check]=df_capped[columns_to_check].clip(lower_limit,upper_limit,axis=1)
L1=LabelEncoder()
data["gender"]=L1.fit_transform(data["gender"])
data["hsc_s"]=L1.fit_transform(data["hsc_s"])
data["degree_t"]=L1.fit_transform(data["degree_t"])
data["specialisation"]=L1.fit_transform(data["specialisation"])
data.head()
data=pd.read_csv("pre.csv")
categorical_cols=['gender','hsc_s','degree_t','specialisation']
one_hot_encoded_data=pd.get_dummies(
    data,
    columns=categorical_cols,
)

print(one_hot_encoded_data)
one_hot_encoded_data.to_csv("Final.csv")
